export PLUGIN_EUNOMIA_NAME=gvm

export PLUGIN_EUNOMIA_GIT_DIR=${PLUGIN_DATA}/git/repo
export PLUGIN_EUNOMIA_BUILD_DIR=${PLUGIN_DATA}/build
export PLUGIN_EUNOMIA_PKG_DIR=${PLUGIN_DATA}/pkg
export PLUGIN_EUNOMIA_EXPORT_DIR=${PLUGIN_DATA}/export
# Git Repo PKG TMP DIR
export PLUGIN_EUNOMIA_GIT_REPO_PKG_TMP_DIR=${PLUGIN_DATA}/tmp
# Dockerfiles
export PLUGIN_EUNOMIA_DOCKERFILES_DIR=${PLUGIN_DIR}/config/dockerfiles
export PLUGIN_EUNOMIA_DOCKER_CONTAINER_PREFIX=zmicro_plugin_eunomia_
# Service
export PLUGIN_EUNOMIA_SERVICE_NAME=zmicro_plugin_eunomia
export PLUGIN_EUNOMIA_SERVICE_PORT=${PLUGIN_EUNOMIA_SERVICE_PORT:-9000}
# BUILD
export PLUGIN_EUNOMIA_BUILD_ID=${PLUGIN_EUNOMIA_BUILD_ID}
export PLUGIN_EUNOMIA_BUILD_ID_DIR=$PLUGIN_EUNOMIA_BUILD_DIR/$PLUGIN_EUNOMIA_BUILD_ID
export PLUGIN_EUNOMIA_BUILD_ID_PKG=${PLUGIN_EUNOMIA_BUILD_ID_DIR}.tar.gz
# LOG
export PLUGIN_EUNOMIA_BUILD_LOG=$PLUGIN_EUNOMIA_BUILD_ID_DIR/log.eunomia
# USER
export PLUGIN_EUNOMIA_EXECUTOR_EMAIL=${PLUGIN_EUNOMIA_EXECUTOR_EMAIL:-$EUNOMIA_EXECUTOR_EMAIL}
export PLUGIN_EUNOMIA_EXECUTOR_NAME=${PLUGIN_EUNOMIA_EXECUTOR_NAME:-$EUNOMIA_EXECUTOR_NAME}
export PLUGIN_EUNOMIA_EXECUTOR_ID=${PLUGIN_EUNOMIA_EXECUTOR_ID:-$EUNOMIA_EXECUTOR_ID}

# Queue
export PLUGIN_EUNOMIA_TASK_QUEUE_IS_ENABLED=${PLUGIN_EUNOMIA_TASK_QUEUE_IS_ENABLED:-"true"}
export PLUGIN_EUNOMIA_TASK_QUEUE_COCURRENCY=${PLUGIN_EUNOMIA_TASK_QUEUE_COCURRENCY:-"2"}
export PLUGIN_EUNOMIA_TASK_QUEUE_LOCK=${PLUGIN_EUNOMIA_TASK_QUEUE_LOCK:-"/tmp/zmicro_plugin_eunomia_task_queue.lock"}

# Docker 
export PLUGIN_EUNOMIA_DOCKER_REGISTRY=${PLUGIN_EUNOMIA_DOCKER_REGISTRY:-"docker-ta.thinkingdata.cn"}
if [ -z "$PLUGIN_EUNOMIA_DOCKER_REGISTRY" ]; then
  log::error "[eunomia::build] PLUGIN_EUNOMIA_DOCKER_REGISTRY is required"
  return 1
fi

if [ ! -d "$PLUGIN_EUNOMIA_GIT_DIR" ]; then
  mkdir -p $PLUGIN_EUNOMIA_GIT_DIR
fi

if [ ! -d "$PLUGIN_EUNOMIA_BUILD_DIR" ]; then
  mkdir -p $PLUGIN_EUNOMIA_BUILD_DIR
fi

if [ ! -d "$PLUGIN_EUNOMIA_PKG_DIR" ]; then
  mkdir -p $PLUGIN_EUNOMIA_PKG_DIR
fi

if [ ! -d "$PLUGIN_EUNOMIA_EXPORT_DIR" ]; then
  mkdir -p $PLUGIN_EUNOMIA_EXPORT_DIR
fi

if [ ! -d "$PLUGIN_EUNOMIA_GIT_REPO_PKG_TMP_DIR" ]; then
  mkdir -p $PLUGIN_EUNOMIA_GIT_REPO_PKG_TMP_DIR
fi
